import { Meta } from '@storybook/blocks';

<Meta title="Padrões Técnicos" />

# Padrões Técnicos

Este documento descreve os padrões técnicos e convenções de código adotados no ocean para garantir consistência, manutenibilidade e qualidade do código.

## Estrutura de Componentes

Cada componente no ocean segue uma estrutura consistente:

```
src/components/ComponentName/
├── index.tsx         # Exportação principal do componente
├── ComponentName.tsx # Implementação do componente
├── types.ts          # Tipos e interfaces relacionados ao componente
├── styles.scss       # Estilos específicos do componente (quando necessário)
└── __tests__/        # Testes do componente
    └── ComponentName.test.tsx
```

### Exemplo de Implementação

```tsx
// src/components/Button/index.tsx
export { default } from './Button';
export * from './types';

// src/components/Button/types.ts
import { ButtonHTMLAttributes, ReactNode } from 'react';

export type ButtonVariant = 'insurance' | 'banking' | 'health' | 'negative' | 'disabled';
export type ButtonStyle = 'primary' | 'secondary' | 'ghost';
export type ButtonSize = 'small' | 'large';

export interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: ButtonVariant;
  styles?: ButtonStyle;
  size?: ButtonSize;
  children: ReactNode;
}

// src/components/Button/Button.tsx
import React from 'react';
import { ButtonProps } from './types';

const Button = ({
  variant = 'insurance',
  styles = 'primary',
  size = 'large',
  children,
  ...restProps
}: ButtonProps) => {
  const composedClassName = `btn --${variant}-${styles} --${size}`;

  return (
    <button className={composedClassName} {...restProps}>
      {children}
    </button>
  );
};

export default Button;
```

## Convenções de Nomenclatura

### Componentes

- Use PascalCase para nomes de componentes: `Button`, `CardContent`, `Typography`
- Use nomes descritivos que indiquem a função do componente
- Evite abreviações, exceto quando amplamente reconhecidas

### Props

- Use camelCase para nomes de props: `onClick`, `isDisabled`, `hasError`
- Use nomes descritivos e consistentes em todos os componentes
- Prefixe props booleanas com `is`, `has`, `should` ou similar: `isOpen`, `hasIcon`, `shouldRender`

### Tipos e Interfaces

- Use PascalCase para tipos e interfaces: `ButtonProps`, `TypographyVariant`
- Sufixe interfaces de props com `Props`: `ButtonProps`, `ModalProps`
- Sufixe tipos de variantes com `Variant`, `Style`, `Size`, etc.: `ButtonVariant`, `ColorStyle`

### CSS

- Use kebab-case para classes CSS: `btn`, `card-content`, `typography`
- Use prefixos de dois hífens para modificadores: `--primary`, `--large`, `--disabled`
- Use BEM (Block Element Modifier) para estruturar classes CSS

## TypeScript

O ocean é construído com TypeScript para garantir segurança de tipos e melhor experiência de desenvolvimento.

### Diretrizes de TypeScript

- Defina tipos explícitos para todas as props de componentes
- Use interfaces para props de componentes
- Use tipos para enums e unions
- Evite o uso de `any`; prefira `unknown` quando necessário
- Use tipos genéricos quando apropriado
- Documente interfaces e tipos complexos

### Exemplo de Tipos Bem Definidos

```tsx
// Bom: tipos bem definidos
interface CardContentProps {
  title: string;
  description: string;
  image?: {
    url: string;
    alt: string;
  };
  links?: Array<{
    href: string;
    label: string;
    target?: '_blank' | '_self';
  }>;
  onAction?: (actionType: 'click' | 'hover') => void;
}

// Evite: tipos vagos
interface PoorCardContentProps {
  title: any;
  description: any;
  image?: any;
  links?: any[];
  onAction?: Function;
}
```

## Testes

Todos os componentes devem ser testados adequadamente:

### Tipos de Testes

- **Testes Unitários**: Testar componentes isoladamente
- **Testes de Integração**: Testar interações entre componentes
- **Testes de Acessibilidade**: Garantir que os componentes sejam acessíveis
- **Testes Visuais**: Garantir que os componentes sejam renderizados corretamente

### Ferramentas de Teste

- Jest para testes unitários e de integração
- React Testing Library para testes de componentes
- Axe para testes de acessibilidade
- Storybook para testes visuais

### Exemplo de Teste

```tsx
// src/components/Button/__tests__/Button.test.tsx
import React from 'react';
import { render, screen, fireEvent } from '@testing-library/react';
import Button from '../Button';

describe('Button', () => {
  it('renders correctly with default props', () => {
    render(<Button>Click me</Button>);
    const button = screen.getByText('Click me');

    expect(button).toBeInTheDocument();
    expect(button).toHaveClass('btn --insurance-primary --large');
  });

  it('applies custom variant, style and size', () => {
    render(
      <Button variant="banking" styles="secondary" size="small">
        Custom Button
      </Button>
    );

    const button = screen.getByText('Custom Button');
    expect(button).toHaveClass('btn --banking-secondary --small');
  });

  it('handles click events', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);

    fireEvent.click(screen.getByText('Click me'));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  it('is disabled when disabled prop is true', () => {
    render(<Button disabled>Disabled Button</Button>);

    const button = screen.getByText('Disabled Button');
    expect(button).toBeDisabled();
  });
});
```

## Documentação

Cada componente deve ser bem documentado:

### Documentação de Componentes

- Descrição do componente e seu propósito
- Lista de props com tipos e descrições
- Exemplos de uso
- Notas sobre acessibilidade
- Variações e estados

### Documentação de Código

- Use JSDoc para documentar funções e componentes complexos
- Documente decisões de design não óbvias
- Adicione comentários para explicar lógica complexa

### Exemplo de JSDoc

```tsx
/**
 * Modal component that displays content in an overlay.
 *
 * @param {object} props - Component props
 * @param {string} props.title - The title of the modal
 * @param {string} [props.subtitle] - Optional subtitle for the modal
 * @param {ReactNode} props.children - Content to be displayed in the modal
 * @param {boolean} props.isOpen - Whether the modal is open
 * @param {() => void} props.onClose - Function to call when the modal is closed
 * @param {string} [props.size='medium'] - Size of the modal ('small', 'medium', 'large')
 *
 * @example
 * <Modal
 *   title="Confirmation"
 *   isOpen={isModalOpen}
 *   onClose={() => setIsModalOpen(false)}
 * >
 *   <p>Are you sure you want to continue?</p>
 *   <Button onClick={handleConfirm}>Confirm</Button>
 * </Modal>
 */
```

## Performance

Otimize os componentes para performance:

### Diretrizes de Performance

- Use React.memo para componentes que não precisam ser re-renderizados frequentemente
- Use useCallback para funções passadas como props
- Use useMemo para cálculos caros
- Evite renderizações desnecessárias
- Otimize imagens e assets
- Implemente lazy loading quando apropriado

### Exemplo de Otimização

```tsx
// Uso de React.memo
const OptimizedComponent = React.memo(({ value }) => {
  return <div>{value}</div>;
});

// Uso de useCallback
const Component = ({ id }) => {
  const handleClick = useCallback(() => {
    console.log(`Item ${id} clicked`);
  }, [id]);

  return <Button onClick={handleClick}>Click me</Button>;
};

// Uso de useMemo
const ExpensiveComponent = ({ data }) => {
  const processedData = useMemo(() => {
    return data.map(item => complexProcessing(item));
  }, [data]);

  return <div>{processedData.map(renderItem)}</div>;
};
```

## Acessibilidade

Todos os componentes devem seguir as diretrizes de acessibilidade:

### Diretrizes de Acessibilidade

- Use elementos semânticos HTML
- Adicione atributos ARIA quando necessário
- Garanta que todos os elementos interativos sejam acessíveis por teclado
- Forneça alternativas em texto para conteúdo não textual
- Mantenha contraste de cores adequado
- Teste com leitores de tela

## Versionamento e Releases

O ocean segue o Versionamento Semântico (SemVer):

- **Versão Patch (1.0.x)**: Correções de bugs e pequenas melhorias
- **Versão Minor (1.x.0)**: Novos recursos compatíveis com versões anteriores
- **Versão Major (x.0.0)**: Mudanças que quebram compatibilidade

## Contribuição

Consulte o [Guia de Contribuição](./contributing.md) para informações sobre como contribuir com o ocean.
